<!DOCTYPE html>

{% extends "eventmaker/base.html" %}
{% load staticfiles %} 
	<!-- Page header with imports-->
	{% block head_block %}
        <script src="{% static 'jquery/jquery.js' %}"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link type="text/css" rel="stylesheet" href="{% static 'eventmakerapp/eventpage.css' %}">
        {{ form.media }}
	{% endblock %}
			
	<!-- Page Content -->
	{% block body_block %}
	
		{% if event %}
			<!-- Event Picture and details -->
			<br>
            {% if event.picture %}
			<div class="w3-container  w3-cell" >
			<p><img src="{{ event.picture.url }}" class="w3-round imageSize" alt="Picture of Event"></p>
			</div>
			{% else %}
			<div class="w3-container  w3-cell" >
			<p><img src={% static 'images/default.png' %} class="w3-round imageSize" alt="Picture of Event"/></p>
			</div>
			
            {% endif %}
			  
			<div class="w3-container w3-cell info w3-text-black">
				<p><h2 class="w3-text-purple">{{ event.title }}</h2></p>
				<p class="details">Details<p>
				<p class="info">Time - {{ event.time }}</p>
				<p class="info">Price - Â£{{ event.price }}</p>
				<p class="info">Location -
                {% csrf_token %}
                {% for field in form.visible_fields %}
                    {% ifequal field.name "location" %}
                        {{ field.errors }}
                        {{ field.help_text }}
                        {{ field }}
                    {% endifequal %}
                {% endfor %}
                </p>
				<p class="info">Posted By - <a href="{% url 'eventmakerapp:userProfile' event.host %}">{{ event.host }}</a> </p>
			</div>
			
			<!-- Event description -->
			<hr>
			<div class="w3-padding-8 w3-container" style="background-color:rgb(225, 225, 225)">	
				<br>
				<h2 class="w3-text-purple">About the Event</h2>
				<p>{{ event.description }}</p>
				<br>
				<br>
			</div>
			<hr>
			
			<!-- Event Comments -->
			<div class="w3-container w3-padding-8">
				<h2 class="w3-text-purple">Comments</h2>
			</div>
			
			<div class="w3-container">
			{% if user.is_authenticated %}
				<p><a href="{% url 'eventmakerapp:makecomment' event.title %}">Leave Comment</a></p>
			{% else %}
				<p><a href="{% url 'eventmakerapp:login' %}">Login</a> to leave a comment</p>			
			{% endif %}
			</div>
			
			<!-- List of Comments -->
			<div class="w3-container">
			{% if comments %}
				<ul class="w3-ul ">
				{% for comment in comments %}
					
						<li class="w3-bar">
								<img src="{{ comment.user.picture }}" class="w3-bar-item w3-circle w3-hide-small" style="width:45px">
							<div class="w3-bar-item">
								<p> <a href="{% url 'eventmakerapp:userProfile' comment.user %}">{{ comment.user.username }}</a><br>
								{{ comment.data }}</p>	
							</div>
						</li>						
				{% endfor %}
				</ul>
			</div>
			{% else %}
				<strong>No Comments</strong>
			{% endif %}
		
		{% else %}
			<strong>Event Does not exist - <a href="{% url 'eventmakerapp:index' %}">back</a></strong>
		{% endif %}

		<!-- Event Likes-->
		<form action = "{% url 'eventmakerapp:show_event' event.title %}" method = "POST">
			{% csrf_token %}
			<button type = "submit", name = "like_button", value = "{{event.id}}", class = "btn btn-primary btn-sm">Like</button>
		</form>

		<!-- Event Join-->
		<form action = "{% url 'eventmakerapp:show_event' event.title %}" method = "POST">
			{% csrf_token %}
			<button type = "submit", name = "join_button", value = "{{event.id}}", class = "btn btn-primary btn-sm">Join</button>
		</form>
		
	{% endblock %}